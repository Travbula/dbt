version: 2

models:
  - name: dim_race
    description: Dimension for races
    meta:
      joins:
        - join: fct_horse_in_race
          sql_on: ${dim_race.race_id} = ${fct_horse_in_race.race_id}
    columns:
      - name: race_id
        description: ID of race
        tests:
          - unique
          - not_null
      - name: racetrack_id
        description: ID of racetrack where race happened
      - name: race_name
        description: Name of the race
      - name: date
        description: Date the race happened
      - name: distance
        description: Distance of the race
      - name: race_form
        description: Form of the race
      - name: start_method
        description: Start method of the race
      - name: number_of_horses_to_start
        description: The number of horses who started in the race
        meta:
          metrics:
            avg_number_of_horses_to_start:
                type: average
      - name: total_prize_pool
        description: Total amount of prize money in the race